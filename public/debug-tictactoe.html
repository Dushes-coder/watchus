<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç–ª–∞–¥–∫–∞: –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</title>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/buttons.css">
    <link rel="stylesheet" href="css/games.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .debug-panel {
            background: #f5f5f5;
            border: 1px solid #ddd;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .debug-panel h3 {
            margin-top: 0;
            color: #333;
        }
        .game-state-display {
            background: #fff;
            border: 1px solid #ccc;
            padding: 10px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }
        .control-buttons {
            margin: 20px 0;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .control-buttons button {
            padding: 8px 16px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .control-buttons button:hover {
            background: #0056b3;
        }
        .control-buttons button.secondary {
            background: #6c757d;
        }
        .control-buttons button.secondary:hover {
            background: #545b62;
        }
    </style>
</head>
<body>
    <h1>üß™ –û—Ç–ª–∞–¥–∫–∞: –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</h1>

    <div class="control-buttons">
        <button id="startLocalBtn">üéÆ –ù–∞—á–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –∏–≥—Ä—É</button>
        <button id="startBotBtn">ü§ñ –ò–≥—Ä–∞ —Å –±–æ—Ç–æ–º</button>
        <button id="resetBtn" class="secondary">üîÑ –°–±—Ä–æ—Å–∏—Ç—å –∏–≥—Ä—É</button>
        <button id="logStateBtn" class="secondary">üìä –õ–æ–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è</button>
    </div>

    <div id="activeGameContent">
        <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –∏–≥—Ä—ã –≤—ã—à–µ</p>
    </div>

    <div class="debug-panel">
        <h3>–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
        <div class="game-state-display" id="debugInfo">
            –ò–≥—Ä–∞ –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞
        </div>
    </div>

    <script type="module">
        // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–æ–¥—É–ª–∏ –∏–≥—Ä—ã
        import { TicTacToeGame } from './js/modules/games/TicTacToeGame.js';
        import { BaseGame } from './js/modules/core/BaseGame.js';

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        window.debugGame = null;
        window.debugMode = 'local'; // 'local' –∏–ª–∏ 'bot'

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        function updateDebugInfo() {
            const debugEl = document.getElementById('debugInfo');
            if (!window.debugGame) {
                debugEl.textContent = '–ò–≥—Ä–∞ –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞';
                return;
            }

            const state = window.debugGame.gameState;
            const info = `
–ò–≥—Ä–∞: ${window.debugGame.gameType}
–†–µ–∂–∏–º: ${window.debugMode}
–¢–µ–∫—É—â–∏–π –∏–≥—Ä–æ–∫: ${state.currentPlayer}
–ú–æ–π —Å–∏–º–≤–æ–ª: ${window.debugGame.mySymbol}
–°–∏–º–≤–æ–ª –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞: ${window.debugGame.opponentSymbol}
–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞: ${state.gameOver}
–ü–æ–±–µ–¥–∏—Ç–µ–ª—å: ${state.winner || '–Ω–µ—Ç'}

–î–æ—Å–∫–∞:
${state.board.map(row => row.map(cell => cell || '-').join(' ')).join('\n')}

–°–µ—Ç–µ–≤–∞—è –∏–≥—Ä–∞: ${window.debugGame.isNetworkGame}
            `.trim();

            debugEl.textContent = info;
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
        document.getElementById('startLocalBtn').addEventListener('click', () => {
            console.log('Starting local TicTacToe game');
            window.debugMode = 'local';

            // –°–æ–∑–¥–∞–µ–º –∏–≥—Ä—É
            window.debugGame = new TicTacToeGame();
            window.debugGame.currentOpponent = { type: 'player', name: '–ò–≥—Ä–æ–∫ 2', emoji: 'üë§' };

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º
            if (window.debugGame.init()) {
                console.log('Local game initialized successfully');
                updateDebugInfo();
            } else {
                console.error('Failed to initialize local game');
            }
        });

        document.getElementById('startBotBtn').addEventListener('click', () => {
            console.log('Starting TicTacToe game with bot');
            window.debugMode = 'bot';

            // –°–æ–∑–¥–∞–µ–º –∏–≥—Ä—É
            window.debugGame = new TicTacToeGame();
            window.debugGame.currentOpponent = { type: 'bot', name: '–ë–æ—Ç', emoji: 'ü§ñ' };

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º
            if (window.debugGame.init()) {
                console.log('Bot game initialized successfully');
                updateDebugInfo();
            } else {
                console.error('Failed to initialize bot game');
            }
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            if (window.debugGame) {
                console.log('Resetting game');
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                window.debugGame.gameState = {
                    board: window.debugGame.createEmptyBoard(),
                    currentPlayer: 'X',
                    gameOver: false,
                    winner: null
                };
                window.debugGame.render();
                updateDebugInfo();
            }
        });

        document.getElementById('logStateBtn').addEventListener('click', () => {
            console.log('Current game state:', window.debugGame);
            updateDebugInfo();
        });

        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–ª–∏–∫–æ–≤ –ø–æ –∫–ª–µ—Ç–∫–∞–º
        window.handleTicTacToeCellClick = function(row, col) {
            console.log(`Cell clicked: [${row}, ${col}]`);
            if (window.debugGame && window.debugGame.handleCellClick) {
                window.debugGame.handleCellClick(row, col);
                // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
                setTimeout(updateDebugInfo, 100);
            }
        };

        console.log('Debug page initialized');
        updateDebugInfo();
    </script>
</body>
</html>
